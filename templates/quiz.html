{% extends "base.html" %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>{{ quiz.title }}</h3>
    <div class="badge badge-time p-2">‚è≥ Time left: <span id="timer"></span></div>
  </div>
  <form method="post" id="quiz-form">
    {% for q in quiz.questions %}
      <div class="card p-3 mb-3">
        <div class="fw-semibold mb-2">{{ loop.index }}. {{ q.text }}</div>
        <div class="form-check"><input class="form-check-input" type="radio" name="{{ q.id }}" value="A" id="q{{q.id}}A"><label class="form-check-label ms-1" for="q{{q.id}}A">{{ q.option_a }}</label></div>
        <div class="form-check"><input class="form-check-input" type="radio" name="{{ q.id }}" value="B" id="q{{q.id}}B"><label class="form-check-label ms-1" for="q{{q.id}}B">{{ q.option_b }}</label></div>
        <div class="form-check"><input class="form-check-input" type="radio" name="{{ q.id }}" value="C" id="q{{q.id}}C"><label class="form-check-label ms-1" for="q{{q.id}}C">{{ q.option_c }}</label></div>
        <div class="form-check"><input class="form-check-input" type="radio" name="{{ q.id }}" value="D" id="q{{q.id}}D"><label class="form-check-label ms-1" for="q{{q.id}}D">{{ q.option_d }}</label></div>
      </div>
    {% endfor %}
    <button class="btn btn-primary">Submit</button>
  </form>

  <script>
    let remaining = {{ quiz.duration_minutes }} * 60;
    const timerEl = document.getElementById('timer');
    function tick() {
      const m = Math.floor(remaining/60);
      const s = remaining % 60;
      timerEl.textContent = String(m).padStart(2,'0')+":"+String(s).padStart(2,'0');
      if (remaining <= 0) {
        document.getElementById('quiz-form').submit();
      } else {
        remaining--; setTimeout(tick, 1000);
      }
    }
    tick();
  </script>
{% endblock %}